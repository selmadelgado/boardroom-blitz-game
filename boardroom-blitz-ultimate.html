<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Boardroom Blitz: Ultimate Memory Match</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #1a5276, #2980b9); color:#fff; text-align:center; padding:20px; min-height:100vh; }
    h1 { margin:20px 0; font-size:2.5em; text-shadow:2px 2px 4px rgba(0,0,0,0.3); }
    #timer { font-size:1.5em; margin:15px 0; font-weight:bold; }
    #game { display:grid; grid-template-columns:repeat(6, 1fr); gap:12px; max-width:900px; margin:20px auto; }
    .card { background:#fff; color:#1a5276; border-radius:12px; height:120px; cursor:pointer; display:flex; align-items:center; justify-content:center; font-weight:bold; transition:0.3s; box-shadow:0 4px 8px rgba(0,0,0,0.2); }
    .card.visible { background:#1a5276; color:#fff; }
    .card.hidden { background:#ecf0f1; }
    .card.matched { opacity:0; transform:scale(0.8); transition:0.6s; }
    .text { padding:10px; text-align:center; }
    .text strong { display:block; font-size:1em; }
    .text span { font-size:0.8em; opacity:0.8; }
    .missing { color:#e74c3c; font-size:0.8em; }
    #win { display:none; flex-direction:column; align-items:center; justify-content:center; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(26,82,118,0.95); z-index:100; padding:20px; }
    #win h2 { font-size:3em; margin:20px 0; }
    #finalTime { font-size:1.8em; margin:15px 0; }
    #leaderboard { background:rgba(255,255,255,0.95); color:#1a5276; padding:25px; border-radius:16px; max-width:400px; width:100%; margin:20px auto; }
    #leaderboard strong { display:block; margin-bottom:15px; font-size:1.3em; }
    #leaderboardList { list-style:none; }
    #leaderboardList li { margin:10px 0; padding:10px; background:#f8f9fa; border-radius:8px; border-left:4px solid #1a5276; }
    input { padding:12px; font-size:1.1em; width:80%; max-width:300px; margin:15px 0; border-radius:8px; border:none; }
    button { padding:12px 30px; background:#ff6b6b; color:white; border:none; border-radius:8px; font-size:1.1em; cursor:pointer; margin:10px; box-shadow:0 4px 12px rgba(0,0,0,0.2); }
    button:disabled { background:#95a5a6; cursor:not-allowed; }
    @media (max-width:768px) { #game { grid-template-columns:repeat(4, 1fr); } .card { height:100px; } }
  </style>
</head>
<body>
  <h1>Boardroom Blitz: Ultimate Memory Match</h1>
  <div id="timer">Time: 0s</div>
  <div id="game"></div>

  <div id="win">
    <h2>YOU WIN!</h2>
    <div id="finalTime"></div>
    <input type="text" id="playerName" placeholder="Your Name" maxlength="20" />
    <button id="saveScore">Save Score</button>
    <div id="leaderboard">
      <strong>Leaderboard (Top 10)</strong>
      <ul id="leaderboardList"><li>Loading...</li></ul>
    </div>
    <button onclick="location.reload()">Play Again</button>
  </div>

  <audio id="winnerMusic" src="https://cdn.jsdelivr.net/gh/tonetheman/winner@v1.0.0/winner.mp3" preload="auto"></audio>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script type="module">
    // ==================== FIREBASE CONFIG ====================
    const firebaseConfig = {
      apiKey: "AIzaSyC0UwDJgS2ZzNgVn9axmdWN6FSVxihgZe8",
      authDomain: "boardroom-blitz-leaderboard.firebaseapp.com",
      projectId: "boardroom-blitz-leaderboard",
      storageBucket: "boardroom-blitz-leaderboard.firebasestorage.app",
      messagingSenderId: "54754880904",
      appId: "1:54754880904:web:b594cf6fcab889d922de3d",
      measurementId: "G-V11RN0QEP7"
    };

    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ==================== DATA ====================
    const CSV_DATA = `Name,Company
Sarah Ballard,American Cancer Society
Victoria Brown,Elemental Advisors
Colbie Campbell,Slates Harwell Campbell LLP
Leigh-Ann Carney,DFPS
Casey Colosky,Stonebriar Village
Melanie Daugherty,Culture Space
Amy Derrick,Dallas County District Attorney
Bill Eifert,AT&T
Travis Ewert,Colliers
Leah Ewing,Sumsol LLC
Chief Griffith,Dallas Police Department
David Gunderson,Cosair Ventures
Kirsten Hill,KPMG
Steve Martin,Frost Bank
Rafael Maya,PWC
Michael Moghtader,Amawaterways
Toby Moon,Oportun
Valencia Nash,Justice of the Peace
Corbett Nichter,The MAPP Group
Bill Richmond,Platt Cheema Richmond
Katie Samler,Goranson Bain Ausley
Erin Schumacher,Cambridge Associates
Michael Simmons,Ulta Beauty
John Slates,Slates Harwell Campbell
Clayton Sporich,Tap Rock Resources
Ellis Thomas,The Stream Foundation
Ashley Zickefoose,Dave & Busters`;

    const IMG_EXT = '.png';
    let cards = [], selected = [], lock = false, startTime, timerId;
    const gameDiv = document.getElementById('game');
    const winDiv = document.getElementById('win');
    const finalTimeEl = document.getElementById('finalTime');
    const leaderboardList = document.getElementById('leaderboardList');
    const saveScoreBtn = document.getElementById('saveScore');
    const playerNameInput = document.getElementById('playerName');
    const winnerMusic = document.getElementById('winnerMusic');

    // ==================== LEADERBOARD ====================
    async function saveScore(name, time) {
      try {
        await addDoc(collection(db, 'scores'), { name, time, date: new Date() });
      } catch (e) {
        console.error('Save failed:', e);
        let scores = JSON.parse(localStorage.getItem('memoryLeaderboard') || '[]');
        scores.push({ name, time });
        scores.sort((a, b) => a.time - b.time);
        scores = scores.slice(0, 10);
        localStorage.setItem('memoryLeaderboard', JSON.stringify(scores));
      }
    }

    async function loadLeaderboard() {
      try {
        const q = query(collection(db, 'scores'), orderBy('time'), limit(10));
        const snapshot = await getDocs(q);
        const scores = snapshot.docs.map(doc => doc.data());
        leaderboardList.innerHTML = scores.length
          ? scores.map(s => `<li><strong>${s.name}</strong> — ${s.time}s</li>`).join('')
          : '<li>No scores yet!</li>';
      } catch (e) {
        const scores = JSON.parse(localStorage.getItem('memoryLeaderboard') || '[]');
        leaderboardList.innerHTML = scores.length
          ? scores.map(s => `<li><strong>${s.name}</strong> — ${s.time}s</li>`).join('')
          : '<li>No scores yet!</li>';
      }
    }

    // ==================== GAME ====================
    function safeName(name) { return name.replace(/[\/\\:*?"<>|]/g, '').replace(/\s+/g, '_'); }

    CSV_DATA.trim().split('\n').slice(1).forEach((line, i) => {
      const [name, company] = line.split(',').map(s => s.trim());
      const img = safeName(name) + IMG_EXT;
      cards.push({id: i, type: 'photo', img, name, company});
      cards.push({id: i, type: 'text', img, name, company});
    });

    function shuffle(a) { for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; } }
    shuffle(cards);
    render();
    startTimer();

    function render() {
      gameDiv.innerHTML = '';
      cards.forEach(c => {
        const card = document.createElement('div');
        card.className = 'card visible';
        card.dataset.id = c.id;
        card.dataset.type = c.type;
        if (c.type === 'photo') {
          const img = document.createElement('img');
          img.src = c.img;
          img.alt = c.name;
          img.onerror = () => card.innerHTML = `<div class="missing">MISSING<br><small>${c.img}</small></div>`;
          card.appendChild(img);
        } else {
          card.innerHTML = `<div class="text"><strong>${c.name}</strong><span>${c.company}</span></div>`;
        }
        card.onclick = () => flip(card);
        gameDiv.appendChild(card);
      });
    }

    function flip(card) {
      if (lock || card.classList.contains('hidden') || card.classList.contains('matched')) return;
      card.classList.remove('visible'); card.classList.add('hidden'); card.innerHTML = ''; selected.push(card);
      if (selected.length === 2) {
        lock = true;
        const [a, b] = selected;
        if (a.dataset.id === b.dataset.id && a.dataset.type !== b.dataset.type) {
          setTimeout(() => {
            a.classList.add('matched'); b.classList.add('matched');
            setTimeout(() => { a.remove(); b.remove(); checkWin(); }, 600);
